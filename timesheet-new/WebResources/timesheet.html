<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Timesheet Control</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
        }
        #controlContainer {
            width: 100%;
            height: 100%;
            min-height: 600px;
        }
    </style>
</head>
<body>
    <div id="controlContainer"></div>

    <script>
        // Initialize the PCF control when the page loads
        window.addEventListener('load', function() {
            // Get the container element
            const container = document.getElementById('controlContainer');

            // Create a config object for the control
            const controlConfig = {
                componentId: "uit_UIT.TimesheetControl",
                containerId: "controlContainer"
            };

            // Initialize the control
            if (window.parent && window.parent.Xrm) {
                const globalContext = window.parent.Xrm.Utility.getGlobalContext();
                
                // Create the control
                const control = window.parent.ComponentFramework.createControl(
                    controlConfig.componentId,
                    container,
                    {
                        context: globalContext,
                        parameters: {},
                        resources: {}
                    }
                );

                // Handle window resize
                window.addEventListener('resize', function() {
                    if (control && control.updateView) {
                        control.updateView();
                    }
                });

                // Handle page visibility changes
                document.addEventListener('visibilitychange', function() {
                    if (!document.hidden && control && control.updateView) {
                        control.updateView();
                    }
                });
            } else {
                container.innerHTML = 'Error: This page must be loaded within Dynamics 365.';
            }
        });
    </script>
</body>
</html> 